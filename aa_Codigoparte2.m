[cite_start]%%%% Parte 2 Tubeira [cite: 307]
[cite_start]%% Par metros de entrada [cite: 308]
D_3 = 0.014; [cite_start]% Tamanho da sa da em 3 [m] [cite: 309]
A_3 = D_3; [cite_start]% rea da sa da 3 [m^2] [cite: 312, 313]
D = 0.05; [cite_start]% Tamanho de entrada do componente [m] [cite: 315]
A = D; [cite_start]% rea de entrada e sa da do componente [m^2] [cite: 316, 314]
A_c = A_3/sqrt((1/M3_opt^2)*(2/(gamma+1)+(gamma-1)/(gamma+1) *M3_opt^2)^((gamma+1)/(gamma-1))); [cite_start]% rea cr tica [cite: 318, 319, 320]
D_c = A_c; [cite_start]% Tamanho da regi o cr tica [m] [cite: 321]
A_M = @(M) sqrt ((1/(M^2))*((2/(gamma+1))*(1+((gamma-1)*(M^2)/2)))^((gamma+1)/(gamma-1))); [cite_start]% rea de Mach [m^2] [cite: 322, 323]
A_C = A_3./A_M(M3_opt); [cite_start]% rea cr tica [m^2] [cite: 324, 327]
[cite_start]F = @(M) A./A_C - A_M(M); [cite: 325]
[cite_start]f = [0.01 1.49]; [cite: 326]
M_4 = fzero(F,f); [cite_start]% Mach na Esta o 4 [cite: 328, 329]

[cite_start]%% Propriedades na Esta o 4 [cite: 330, 331]
RT3 = (1 + (((gamma-1)*(M3_opt.^2))/2)); [cite_start]% Raz o de temperatura em 3 [cite: 332]
RP3 = (1+((gamma-1)*(M3_opt^2)/2))^((gamma)./(gamma-1)); [cite_start]% Raz o de press o em 3 [cite: 333, 335]
[cite_start]P4 = (1+((gamma-1)*(M_4^2)/2))^((-gamma)/(gamma-1)); [cite: 334, 336]
[cite_start]T4 = (1+((gamma-1)*(M_4^2)/2))^(-1); [cite: 337]
P_4 = P4*RP3*p3_opt; [cite_start]% Press o [Pa] [cite: 338]
T_4 = T4*RT3*T3_opt; [cite_start]%Temperatura [K] [cite: 339]
RT4 = T3_opt/T_4; [cite_start]% Raz o de temperatura em 4 [cite: 340]
RP4 = P_4/P4; [cite_start]% Raz o de pressao em 4 [cite: 341]
Rho_4 = rho3_opt/(RT4)^(1/(gamma-1)); [cite_start]%Massa especifica [kg/m^3] [cite: 342]
a_4 = sqrt(gamma*T_4*R); [cite_start]% Velocidade do som [m/s] [cite: 343, 344]
V_4 = M_4*a_4; [cite_start]% Velocidade [m/s] [cite: 345]
[cite_start]T03 = T3_opt*(1+(gamma-1)/2*M3_opt^2); [cite: 346]
[cite_start]P03 = p3_opt* (T03/T3_opt)^(gamma/(gamma-1)); [cite: 347]
[cite_start]Rho03 = rho3_opt* (T03/T3_opt)^(1/(gamma-1)); [cite: 347]
[cite_start]% Propriedades de estagna o em 4 [cite: 348, 349]
[cite_start]% S o iguais de 3 isentr pico [cite: 350]
T04 = T03; P04 = P03; [cite_start]Rho04 = Rho03; [cite: 351, 352]

[cite_start]%% Adi o de calor Esta o 5 [cite: 353, 354]
T = 1500; [cite_start]% Temperatura do calor adicionado [K] [cite: 355]
T_5 = T_4 + T; [cite_start]% Temperatura em 5 [K] [cite: 355]
[cite_start]RazTemp = @(M) ((((1+gamma*M_4^2)/(1+gamma*M^2)) * (M/M_4)^2)); [cite: 359]
[cite_start]T_func = @(M) RazTemp(M) - (T_5/T_4); [cite: 360]
M_5 = fzero(T_func, f); [cite_start]% Mach na Esta o 5 [cite: 361, 362, 363]
[cite_start]% Propriedades [cite: 364]
[cite_start]P5_P4 = (1+(gamma*(M_4^2)))/(1+(gamma*(M_5^2))); [cite: 365, 366]
P_5 = P5_P4*P_4; [cite_start]% Press o [Pa] [cite: 367]
[cite_start]% Raz o de temperatura em 5 [cite: 368]
[cite_start]T5_T4 = (((1+(gamma*(M_4^2)))/(1+(gamma*(M_5^2))))^2)*((M_5/M_4)^2); [cite: 369]
Rho_5 = Rho_4*((1+gamma*M_4^2)/(1+gamma*M_5^2))*(M_4/M_5)^2; [cite_start]% Massa especifica [kg/m^3] [cite: 370, 371]
a_5 = sqrt(gamma*T_5*R); [cite_start]% Velocidade do som [m/s] [cite: 372]
V_5 = M_5*a_5; [cite_start]% Velocidade [m/s] [cite: 373]
T05 = T04*(T_5/T_4)*((1+(gamma-1)/2*M_5^2)/(1+(gamma-1)/2*M_4^2)); [cite_start]% Temperatura de estagna o em 5 [cite: 374, 376, 378]
P05 = P04*(P_5/P_4)*((1+(gamma-1)/2*M_5^2)/(1+(gamma-1)/2*M_4^2))^(gamma/(gamma-1)); [cite_start]% Press o de estagna o em 5 [cite: 375, 379, 380, 381]
Rho05 = P05/(R*T05); [cite_start]% Massa espec fica de estagna o em 5 [cite: 382, 383]

[cite_start]%% Esta o 6 [cite: 384, 385]
[cite_start]% garganta da tubeira [cite: 386]
[cite_start]% Propriedades [cite: 387]
[cite_start]A_g = A/sqrt((1/M_5^2)*(2/(gamma+1)+(gamma-1)/(gamma+1)*M_5^2)^((gamma+1)/(gamma-1))); [cite: 388, 389]
Dt = A_g; [cite_start]% rea da garganta [cite: 390]
M_6 = 1; [cite_start]% Pela bibliografia Mach na garganta [cite: 391]
[cite_start]% Propriedades de estagna o em 6 s o iguais de 5 isentr pico [cite: 392]
T06 = T05; P06 = P05; [cite_start]Rho06 = Rho05; [cite: 393]
T_6 = T06/(1+((gamma-1)/2)*M_6^2); [cite_start]% [K] Temperatura [K] [cite: 394, 395]
P_6 = P06/((1+(gamma-1)/2*M_6^2)^(gamma/(gamma-1))); [cite_start]% Press o [Pa] [cite: 395]
Rho_6 = Rho06/(T06/T_6)^(1/(gamma-1)); [cite_start]% Massa especifica [kg/m^3] [cite: 396, 397]
a_6 = sqrt(gamma*R*T_6); [cite_start]% Velocidade do som [m/s] [cite: 398]
V_6 = M_6*a_6; [cite_start]% Velocidade [m/s] [cite: 399]

[cite_start]%% Esta o 7 [cite: 400, 401]
A_M = @(M) sqrt( (1/(M^2))*((2/(gamma+1))*(1+((gamma-1)*(M^2)/2)))^((gamma+1)/(gamma-1)) ); [cite_start]% rea de Mach [m^2] [cite: 402, 403]
A_g_norm = 1; [cite_start]% Normalizando a rea da garganta [cite: 405, 406, 407, 408]
[cite_start]A2 = A/A_g; [cite: 404]
F = @(M) A2./A_g_norm - A_M(M); [cite_start]% Fun o [cite: 409, 410, 411]
[cite_start]% Encontrar a raiz subs nica [cite: 412]
[cite_start]f_subsonic = [0.01 0.99]; [cite: 413]
[cite_start]M_subsonic = fzero(F, f_subsonic); [cite: 414]
[cite_start]% Encontrar a raiz supers nica [cite: 418]
[cite_start]f_supersonic = [1.01 5]; [cite: 419, 420]
[cite_start]M_supersonic = fzero(F, f_supersonic); [cite: 421, 422]
[cite_start]M_7 = M_supersonic; [cite: 423, 424]
A_c = A_3/sqrt((1/M3_opt^2)*(2/(gamma+1)+(gamma-1)/(gamma+1)*M3_opt^2)^((gamma+1)/(gamma-1))); [cite_start]% Retornando ao valor da rea cr tica [m^2] [cite: 425, 426, 430]
D_c = A_c; [cite_start]% Tamanho da regi o cr tica [m] [cite: 427]
[cite_start]A_g = Dt; [cite: 429]
[cite_start]% Propriedades [cite: 428]
[cite_start]% Propriedades de estagna o em 7 s o iguais de 6 isentr pico [cite: 431]
T07 = T06; P07 = P06; [cite_start]Rho07 = Rho06; [cite: 432]
T_7 = T07/(1+((gamma-1)/2)*M_7^2); [cite_start]% [K] Temperatura [K] [cite: 433, 434]
P_7 = P07/((1+(gamma-1)/2*M_7^2)^(gamma/(gamma-1))); [cite_start]% Press o [Pa] [cite: 435]
Rho_7 = Rho07/(T07/T_7)^(1/(gamma-1)); [cite_start]% Massa especifica [kg/m^3] [cite: 436, 437]
a_7 = sqrt(gamma*R*T_7); [cite_start]% Velocidade do som [m/s] [cite: 438]
V_7 = M_7*a_7; [cite_start]% Velocidade [m/s] [cite: 439]

[cite_start]%% Resultados [cite: 440]
[cite_start]% Tabela de resultados [cite: 441]
[cite_start]T_tubeira = table({'Esta o 4'; 'Esta o 5'; 'Esta o 6'; 'Esta o 7'}, ... [cite: 442, 443, 444, 445, 446, 448, 449]
    [M_4; M_5; M_6; [cite_start]M_7], ... [cite: 450, 451, 452, 453]
    [P_4; P_5; P_6; [cite_start]P_7], ... [cite: 454, 455, 456, 457]
    [T_4; T_5; T_6; [cite_start]T_7], ... [cite: 458, 459, 460, 461]
    [V_4; V_5; V_6; [cite_start]V_7], ... [cite: 462, 463, 464, 465]
    [Rho_4; Rho_5; Rho_6; [cite_start]Rho_7], ... [cite: 466, 467]
    [cite_start]'VariableNames', {'Esta o', 'Mach', 'Press o [Pa]', 'Temperatura [K]', 'Velocidade [m/s]', 'Massa espec fica [Kg/m3]'}); [cite: 468, 469, 470, 471]
[cite_start]disp('~~~~~~ Parte 2 ~~~~~~') [cite: 472]
[cite_start]disp('Propriedades Tubeira:') [cite: 473, 475]
[cite_start]disp(T_tubeira) [cite: 474]
[cite_start]fprintf('Dt [mm]: %.4f \n', Dt*1000); [cite: 476]

[cite_start]%% Gr ficos [cite: 477]
[cite_start]% Fun o para resolver a equa o de Mach [cite: 478, 479]
[cite_start]mach_func = @(M, A_ratio) (A_ratio^2 - (1/M^2)*(2/(gamma+1) + (gamma-1)/(gamma+1)*M^2)^((gamma+1)/(gamma-1))); [cite: 480, 481, 482]

[cite_start]% Prealoca o de vetores [cite: 486]
[cite_start]Tam = 100; [cite: 487]
[cite_start]Ang1 = 20; [cite: 488]
[cite_start]Lt = (D-Dt)/tand(Ang1); [cite: 489]
x = linspace (0, Lt, Tam); [cite_start]% geometria convergente [cite: 490]
[cite_start]y = (Dt-D)/Lt*x+D; [cite: 491]
[cite_start]Ang2 = 15; [cite: 492]
[cite_start]Lt2 = Lt + (D-Dt)/tand(Ang2); [cite: 493]
x1 = linspace (Lt, Lt2, Tam); [cite_start]% geometria divergente [cite: 494]
[cite_start]y1 = (D-Dt)/(Lt2-Lt)*(x1-Lt)+Dt; [cite: 495]
[cite_start]XC = horzcat(x, x1); [cite: 496, 497, 498]
[cite_start]YC = horzcat(y, y1); [cite: 499, 500, 501]
[cite_start]AC = YC; [cite: 502]

[cite_start]% Propriedades em cada ponto ao longo do comprimento da tubeira c nica [cite: 503]
[cite_start]for i = 1: length (XC) [cite: 504]
    [cite_start]A_ratio = AC (i) / A_g; [cite: 505]
    [cite_start]if XC (i) <= Lt [cite: 506]
        [cite_start]M_c(i) = fzero (@(M) mach_func(M, A_ratio), [0.01, 1]); [cite: 508, 509]
    [cite_start]else [cite: 510]
        [cite_start]M_c(i) = fzero (@(M) mach_func(M, A_ratio), [1, 5]); [cite: 511, 513]
    end
    [cite_start]T_c(i) = (1+(gamma-1)/2*M_c(i)^2)^(-1); [cite: 514]
    [cite_start]P_c(i) = (1+(gamma-1)/2*M_c(i)^2)^(-gamma/(gamma-1)); [cite: 515]
    [cite_start]Rho_c(i) = (1+(gamma-1)/2*M_c(i)^2)^(-1/(gamma-1)); [cite: 516]
    [cite_start]a_c(i) = sqrt(gamma*R*T_c(i)*T05); [cite: 517]
    [cite_start]V_c(i) = M_c(i)*a_c(i); [cite: 518]
end

[cite_start]% C lculo das propriedades em cada ponto ao longo do comprimento da tubeira Bell Shape [cite: 519, 520]
% Convergente (usando a mesma geometria cÃ´nica)
[cite_start]% Divergente [cite: 521]
xi_bs = -23.09e-3; [cite_start]% Deslocamento no eixo x [cite: 522, 523, 524]
yi_bs = -67.72e-3; [cite_start]% Deslocamento no eixo y [cite: 525, 528]
raio_bs = 120e-3; [cite_start]% Raio [mm] [cite: 526, 527]
angulo_inicial_bs = 60; [cite_start]% ngulo inicial [cite: 529, 532]
angulo_final_bs = 18.91; [cite_start]% ngulo final [cite: 530, 533]
[cite_start][x_bs, y_bs] = Semicircle (xi_bs, yi_bs, raio_bs, angulo_inicial_bs, angulo_final_bs); [cite: 534, 535]
[cite_start]% Na garganta [cite: 536]
xil_bs = Lt; [cite_start]% Deslocamento no eixo x [cite: 537]
yil_bs = Dt + 2*Dt; [cite_start]% Deslocamento no eixo y [cite: 538, 539]
raiol_bs = Dt*2; [cite_start]% Raio [mm] [cite: 540]
angulo_iniciall_bs = 289.13; [cite_start]% ngulo inicial [cite: 541, 542, 543]
angulo_finall_bs = 236.91; [cite_start]% ngulo final [cite: 544, 546]
[cite_start][x1_bs, y1_bs] = Semicircle (xil_bs, yil_bs, raiol_bs, angulo_iniciall_bs, angulo_finall_bs); [cite: 550, 551]
[cite_start]% Divergente [cite: 552]
xi2_bs = 166.45e-3; [cite_start]% Deslocamento no eixo x [cite: 553, 554, 555]
yi2_bs = -99.97e-3; [cite_start]% Deslocamento no eixo y [cite: 556, 557, 558]
raio2_bs = 150e-3; [cite_start]% Raio [mm] [cite: 559, 564]
angulo_inicial2_bs = 91.16; [cite_start]% ngulo inicial [cite: 560, 565]
angulo_final2_bs = 119.13; [cite_start]% ngulo final [cite: 561, 566]
[cite_start][x2_bs, y2_bs] = Semicircle (xi2_bs, yi2_bs, raio2_bs, angulo_inicial2_bs, angulo_final2_bs); [cite: 562, 563]
[cite_start]XBS = horzcat (x_bs, x1_bs, x2_bs); [cite: 567, 568, 569]
[cite_start]YBS = horzcat (y_bs, y1_bs, y2_bs); [cite: 570, 571, 572, 573]
[cite_start]ABS = YBS; [cite: 574, 575]

[cite_start]for i = 1: length (XBS) [cite: 576]
    [cite_start]A_ratio = ABS (i) / A_g; [cite: 577]
    [cite_start]if XBS (i) <= Lt [cite: 580]
        [cite_start]M_BS (i) = fzero (@(M) mach_func(M, A_ratio), [0.01, 1]); [cite: 578, 581]
    [cite_start]else [cite: 582]
        [cite_start]M_BS (i) = fzero (@(M) mach_func(M, A_ratio), [1, 5]); [cite: 579, 583]
    end
    [cite_start]T_BS (i) = (1+ (gamma-1)/2 * M_BS (i)^2)^(-1); [cite: 585, 586, 587]
    [cite_start]P_BS (i) = (1+ (gamma-1)/2 * M_BS (i)^2)^(-gamma/(gamma-1)); [cite: 588, 589, 597]
    [cite_start]rho_BS (i) = (1 + (gamma-1)/2 * M_BS (i)^2)^(-1/(gamma-1)); [cite: 591, 592, 593]
    [cite_start]a_BS (i) = sqrt (gamma *R*T_BS (i) * T05); [cite: 593, 598]
    [cite_start]V_BS(i) = M_BS (i) * a_BS(i); [cite: 595, 600]
end

[cite_start]figure (3) [cite: 601]
[cite_start]hold on [cite: 602]
[cite_start]plot (XC, M_c, 'linewidth',1.5) [cite: 603]
[cite_start]plot (XBS, M_BS, 'linewidth',1.5) [cite: 604]
[cite_start]grid on [cite: 605]
[cite_start]xlabel('Comprimento [m]', 'FontSize', 14) [cite: 606]
[cite_start]ylabel('Mach', 'FontSize', 14) [cite: 607]
[cite_start]line ([Lt Lt], [0 1], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 608]
[cite_start]line ([0 Lt], [1 1], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 608]
[cite_start]xlim ([0, Lt2]) [cite: 608]
[cite_start]ylim([0.2, 2.3]) [cite: 609]
[cite_start]legend ('Tubeira C nica', 'Tubeira Bell-shape', 'Location', 'Best', 'FontSize', 12); [cite: 610, 611]

[cite_start]figure (4) [cite: 612]
[cite_start]hold on [cite: 613]
[cite_start]plot (XC, P_c, 'linewidth',1.5) [cite: 614]
[cite_start]plot (XBS, P_BS, 'linewidth',1.5) [cite: 615]
[cite_start]grid on [cite: 616]
[cite_start]xlabel('Comprimento [m]', 'FontSize', 14) [cite: 617]
[cite_start]line ([Lt Lt], [0 P_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 618, 619]
[cite_start]line ([0 Lt], [P_c(Tam) P_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 623, 624]
[cite_start]ylabel('$\frac{P}{P_0}$', 'interpreter', 'latex', 'fontsize', 16) [cite: 625]
[cite_start]xlim ([0, Lt2]) [cite: 625]
[cite_start]legend ('Tubeira Cnica', 'Tubeira Bell-shape', 'Location', 'Best', 'FontSize', 12); [cite: 626]

[cite_start]figure (5) [cite: 627]
[cite_start]hold on [cite: 628]
[cite_start]plot (XC, T_c, 'linewidth',1.5) [cite: 629]
[cite_start]plot (XBS, T_BS, 'linewidth',1.5) [cite: 629]
[cite_start]grid on [cite: 630]
[cite_start]xlabel('Comprimento [m]', 'FontSize', 14) [cite: 631, 632]
[cite_start]ylabel('$\frac{T}{T_0}$', 'interpreter', 'latex', 'fontsize', 16) [cite: 632]
[cite_start]line ([Lt Lt], [0 T_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 632, 633, 634]
[cite_start]line ([0 Lt], [T_c(Tam) T_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 635, 636, 637, 638]
[cite_start]xlim([0, Lt2]) [cite: 639]
[cite_start]ylim([0.5,1]) [cite: 640]
[cite_start]legend ('Tubeira Conica', 'Tubeira Bell-shape', 'Location', 'Best', 'FontSize', 12); [cite: 641, 642]

[cite_start]figure (6) [cite: 643]
[cite_start]hold on [cite: 644]
[cite_start]plot (XC, Rho_c, 'linewidth',1.5) [cite: 645]
[cite_start]plot (XBS, rho_BS, 'linewidth', 1.5) [cite: 646]
[cite_start]grid on [cite: 647]
[cite_start]xlabel('Comprimento [m]', 'FontSize', 14) [cite: 648]
[cite_start]ylabel('$\frac{\rho}{\rho_0}$', 'interpreter', 'latex', 'fontsize', 16) [cite: 649]
[cite_start]line ([0 Lt], [Rho_c(Tam) Rho_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 649, 650]
[cite_start]line ([Lt Lt], [0 Rho_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 651, 652]
[cite_start]xlim ([0, Lt2]) [cite: 653]
[cite_start]ylim ([0.1, 1]) [cite: 654]
[cite_start]legend('Tubeira C nica', 'Tubeira Bell-shape', 'Location', 'Best', 'FontSize', 12); [cite: 655, 656]

[cite_start]figure (7) [cite: 657]
[cite_start]hold on [cite: 658]
[cite_start]plot (XC, V_c, 'linewidth',1.5) [cite: 659]
[cite_start]plot(XBS, V_BS, 'linewidth',1.5) [cite: 660]
[cite_start]grid on [cite: 661]
[cite_start]xlabel('Comprimento [m]', 'FontSize', 14) [cite: 662]
[cite_start]ylabel('Velocidade [m/s]', 'FontSize', 14) [cite: 663]
[cite_start]line ([Lt Lt], [0 V_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 664, 665]
[cite_start]line ([0 Lt], [V_c(Tam) V_c(Tam)], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 666, 667]
[cite_start]xlim ([0, Lt2]) [cite: 668]
[cite_start]ylim([200, 1600]) [cite: 669]
[cite_start]legend ('Tubeira C nica', 'Tubeira Bell-shape', 'Location', 'Best', 'FontSize', 12); [cite: 670, 673]

[cite_start]figure (8) [cite: 674]
[cite_start]hold on [cite: 675]
[cite_start]plot(XC, YC, 'linewidth',1.5) [cite: 676]
[cite_start]plot(XBS, YBS, 'linewidth',1.5) [cite: 676]
[cite_start]axis equal [cite: 678]
[cite_start]grid on [cite: 679]
[cite_start]xlabel('Comprimento [m]', 'FontSize', 14) [cite: 680]
[cite_start]ylabel('y [m]', 'FontSize', 14) [cite: 681]
[cite_start]line ([Lt Lt], [0 Dt], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 682, 683, 684, 685, 686, 687, 688, 689]
[cite_start]line ([0 Lt], [Dt Dt], 'linestyle', '--', 'linewidth', 0.5, 'Color', 'k') [cite: 690, 691, 692, 693, 694, 695, 696]
[cite_start]xlim ([0, Lt2]) [cite: 697]
[cite_start]ylim([0, 0.1]) [cite: 698]
[cite_start]legend ('Tubeira C nica', 'Tubeira Bell-shape', 'Location', 'Best', 'FontSize', 12); [cite: 699, 700]